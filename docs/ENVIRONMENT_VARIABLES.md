# Environment Variables Reference

This document lists all environment variables needed for the Sign Company Dashboard.

## Required Variables

### Server Configuration

| Variable | Description | Example | Required |
|----------|-------------|---------|----------|
| `PORT` | Server port | `9000` | No (defaults to 5000) |
| `NODE_ENV` | Environment mode | `production` or `development` | Yes |

### Database

| Variable | Description | Example | Required |
|----------|-------------|---------|----------|
| `MONGODB_URI` | MongoDB connection string | `mongodb+srv://user:pass@cluster.mongodb.net/dbname` | Yes |

### Authentication

| Variable | Description | Example | Required |
|----------|-------------|---------|----------|
| `JWT_SECRET` | Secret key for JWT tokens | `your-super-secret-jwt-key` | Yes |
| `JWT_EXPIRE` | JWT token expiration | `7d` (7 days) | No (defaults to 7d) |

### AWS S3 (File Storage)

| Variable | Description | Example | Required |
|----------|-------------|---------|----------|
| `AWS_ACCESS_KEY_ID` | AWS access key | `AKIAIOSFODNN7EXAMPLE` | Yes |
| `AWS_SECRET_ACCESS_KEY` | AWS secret key | `wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY` | Yes |
| `AWS_REGION` | AWS region | `us-east-1` | Yes |
| `AWS_S3_BUCKET` | S3 bucket name | `sign-company-dashboard-files` | Yes |

### Google Maps

| Variable | Description | Example | Required |
|----------|-------------|---------|----------|
| `GOOGLE_MAPS_API_KEY` | Google Maps API key (backend) | `AIzaSyBOhdyerqv...` | Yes |
| `VITE_GOOGLE_MAPS_API_KEY` | Google Maps API key (frontend) | `AIzaSyBOhdyerqv...` | Yes |

### Client Configuration

| Variable | Description | Example | Required |
|----------|-------------|---------|----------|
| `CLIENT_URL` | Frontend URL | `https://yourapp.onrender.com` | Yes |
| `VITE_API_URL` | API endpoint URL | `https://yourapp.onrender.com/api` | Yes |

## Optional Variables

### AI Search

| Variable | Description | Example | Required |
|----------|-------------|---------|----------|
| `OPENROUTER_API_KEY` | OpenRouter API key for AI search | `sk-or-v1-...` | No |

### Redis Caching

| Variable | Description | Example | Required |
|----------|-------------|---------|----------|
| `REDIS_URL` | Redis connection URL | `redis://localhost:6379` | No |

### Email (Future Feature)

| Variable | Description | Example | Required |
|----------|-------------|---------|----------|
| `EMAIL_HOST` | SMTP host | `smtp.gmail.com` | No |
| `EMAIL_PORT` | SMTP port | `587` | No |
| `EMAIL_USER` | Email username | `your-email@gmail.com` | No |
| `EMAIL_PASS` | Email password | `your-app-password` | No |

---

## Environment-Specific Setup

### Development (.env file in root)

```env
# Server Configuration
PORT=9000
NODE_ENV=development

# MongoDB Configuration
MONGODB_URI=mongodb://localhost:27017/sign-company-dashboard

# JWT Configuration
JWT_SECRET=your-super-secret-jwt-key-change-this
JWT_EXPIRE=7d

# AWS S3 Configuration
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
AWS_REGION=us-east-1
AWS_S3_BUCKET=sign-company-dashboard-files

# Google Maps API
GOOGLE_MAPS_API_KEY=your-google-maps-api-key

# Client URL
CLIENT_URL=http://localhost:5173
VITE_API_URL=http://localhost:9000/api

# AI Search Configuration (Optional)
OPENROUTER_API_KEY=sk-or-v1-your-openrouter-api-key-here

# Redis Cache (Optional)
REDIS_URL=redis://localhost:6379
```

### Production (Render.com)

Configure these in your Render service dashboard under "Environment":

**Required:**
- `NODE_ENV=production`
- `MONGODB_URI` (from MongoDB Atlas)
- `JWT_SECRET` (auto-generated by Render)
- `AWS_ACCESS_KEY_ID`
- `AWS_SECRET_ACCESS_KEY`
- `AWS_REGION=us-east-1`
- `AWS_S3_BUCKET`
- `GOOGLE_MAPS_API_KEY`
- `CLIENT_URL` (your Render service URL)
- `VITE_API_URL` (your Render service URL + /api)
- `VITE_GOOGLE_MAPS_API_KEY`

**Optional:**
- `OPENROUTER_API_KEY` (for AI search)
- `REDIS_URL` (if using Redis)

---

## Frontend Environment Variables (frontend/.env)

For local development only:

```env
VITE_API_URL=http://localhost:9000/api
VITE_GOOGLE_MAPS_API_KEY=your-google-maps-api-key
```

**Note:** In production, these are set in the root .env and passed during the build process.

---

## Security Best Practices

1. **Never commit .env files to git**
   - Already configured in [.gitignore](../.gitignore)
   - Use `.env.example` as a template

2. **Use strong secrets**
   - `JWT_SECRET` should be at least 32 characters
   - MongoDB passwords should be complex
   - AWS credentials should be for limited IAM users

3. **Rotate credentials regularly**
   - Change JWT_SECRET every 90 days
   - Rotate AWS access keys annually
   - Update MongoDB passwords periodically

4. **Limit AWS permissions**
   - Create dedicated IAM user for S3
   - Grant only S3 access (no EC2, etc.)
   - Restrict to specific bucket

5. **Environment-specific values**
   - Use different databases for dev/prod
   - Use different S3 buckets for dev/prod
   - Never use production credentials locally

---

## Troubleshooting

### Missing Environment Variables

If you see errors like:
```
Error: MONGODB_URI is not defined
```

**Solution:** Ensure the variable is set in your .env file or Render dashboard.

### Invalid MongoDB URI

If connection fails:
```
MongooseError: Invalid connection string
```

**Solution:** Check your MongoDB Atlas connection string:
- Password is URL-encoded (special characters like @ should be %40)
- Database name is included
- IP whitelist includes 0.0.0.0/0

### AWS S3 Upload Fails

If file uploads fail:
```
Error: Cannot upload to S3
```

**Solution:**
- Verify AWS credentials are correct
- Check bucket name matches
- Ensure IAM user has S3 permissions
- Verify bucket region matches

### CORS Errors

If API calls fail with CORS errors:

**Solution:** Ensure `CLIENT_URL` matches your frontend URL exactly.

---

## Verification Checklist

Before deploying, verify:

- [ ] All required variables are set
- [ ] MongoDB connection string is valid
- [ ] AWS credentials have been tested
- [ ] Google Maps API key is enabled
- [ ] `CLIENT_URL` matches deployment URL
- [ ] `VITE_API_URL` points to correct API endpoint
- [ ] No .env files are committed to git
- [ ] Strong password for JWT_SECRET
- [ ] Database user has correct permissions

---

## Quick Reference Commands

### Check if environment variables are loaded:
```bash
# Development
node -e "require('dotenv').config(); console.log(process.env.MONGODB_URI)"
```

### Test MongoDB connection:
```bash
# Install MongoDB client
npm install -g mongodb

# Connect
mongo "YOUR_MONGODB_URI"
```

### Test AWS S3 credentials:
```bash
# Install AWS CLI
npm install -g aws-cli

# Configure
aws configure

# Test
aws s3 ls s3://YOUR_BUCKET_NAME
```

---

Generated: 2025-11-18
